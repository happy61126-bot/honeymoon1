<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ–°åŠ å¡~é¦¬çˆ¾åœ°å¤«~å‰éš†å¡ èœœæœˆä¹‹æ—…</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">

    <!-- Config & Styles -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'island-blue': '#0077b6', 
                        'island-light': '#e0f2fe',
                        'sand-gold': '#d4a373',
                        'coral-pink': '#e63946', 
                        'palm-green': '#2a9d8f', 
                    },
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Noto Serif TC"', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .custom-checkbox:checked + label span { background-color: #0077b6; border-color: #0077b6; }
        .custom-checkbox:checked + label span:after { content: '\2714'; display: block; color: white; font-size: 12px; text-align: center; line-height: 20px; }
        
        .route-link { color: #2563eb; text-decoration: none; border-bottom: 1px dotted #2563eb; }
        .route-link:hover { color: #1e40af; border-bottom: 1px solid #1e40af; }

        .expense-table th { background-color: #f3f4f6; color: #374151; font-weight: 600; padding: 8px 4px; font-size: 0.75rem; text-align: center; }
        .expense-table td { padding: 8px 4px; border-bottom: 1px solid #e5e7eb; font-size: 0.8rem; vertical-align: middle; text-align: center; }
        .expense-table tr:last-child td { border-bottom: none; }
    </style>
</head>
<body class="bg-gray-200 font-sans text-gray-700 overflow-hidden h-screen w-screen flex justify-center">

    <div class="w-full max-w-md h-full bg-white shadow-2xl relative flex flex-col overflow-hidden">
        
        <!-- Header -->
        <header class="bg-island-blue text-white p-4 shadow-md z-10 shrink-0">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="font-serif text-xl font-bold tracking-wide"><i class="fa-solid fa-plane-departure mr-2"></i>èœœæœˆä¹‹æ—…</h1>
                    <p class="text-xs text-blue-100 mt-1">Jan 23 - Feb 03 â€¢ 2025</p>
                </div>
                <div class="text-right">
                    <i class="fa-solid fa-umbrella-beach text-2xl opacity-80"></i>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto hide-scrollbar bg-slate-50 pb-20 relative" id="main-content">
            
            <!-- Tab 1: è¡Œç¨‹è¡¨ (Plan) -->
            <div id="tab-plan" class="tab-content active p-4">
                <div class="text-center mb-6">
                    <h2 class="font-serif text-2xl text-island-blue font-bold">æ¯æ—¥è¡Œç¨‹</h2>
                    <div class="h-1 w-16 bg-sand-gold mx-auto mt-2 rounded-full"></div>
                </div>
                <div id="itinerary-container" class="space-y-4"></div>
            </div>

            <!-- Tab 2: è¨˜å¸³èˆ‡åŒ¯ç‡ (Wallet) -->
            <div id="tab-wallet" class="tab-content p-2">
                <div class="text-center mb-4">
                    <h2 class="font-serif text-2xl text-coral-pink font-bold">è¨˜å¸³ç®¡å®¶</h2>
                    <div class="h-1 w-16 bg-sand-gold mx-auto mt-2 rounded-full"></div>
                </div>
                <!-- Rate Calculator -->
                <div class="bg-white rounded-xl shadow-sm p-3 mb-4 border border-gray-100 max-w-[98%] mx-auto">
                    <div class="flex justify-between items-center mb-2 cursor-pointer" onclick="document.getElementById('calc-body').classList.toggle('hidden')">
                        <h3 class="font-bold text-gray-800"><i class="fa-solid fa-calculator text-island-blue mr-2"></i>ç°¡æ˜“åŒ¯ç‡æ›ç®—</h3>
                        <i class="fa-solid fa-chevron-down text-gray-400"></i>
                    </div>
                    <div id="calc-body" class="hidden">
                        <div class="flex gap-2 items-center mb-2">
                            <label class="text-xs text-gray-600 font-bold">åŒ¯ç‡:</label>
                            <input type="number" id="exchange-rate" class="border rounded px-2 py-1 w-20 text-center text-sm" value="4.5" onchange="saveRate()">
                        </div>
                        <div class="flex gap-2 items-center">
                            <input type="number" id="calc-input" placeholder="å¤–å¹£" class="flex-1 bg-gray-50 border border-gray-300 rounded-lg px-2 py-2 text-sm focus:outline-none focus:border-island-blue min-w-0">
                            <i class="fa-solid fa-arrow-right text-gray-400 text-sm"></i>
                            <div id="calc-result" class="flex-1 bg-island-light text-island-blue font-bold text-sm px-2 py-2 rounded-lg text-right min-w-0">0</div>
                        </div>
                    </div>
                </div>
                <!-- Add Expense Form -->
                <div class="bg-white rounded-xl shadow-sm p-3 mb-6 border border-gray-100 relative max-w-[98%] mx-auto overflow-hidden">
                    <h3 class="font-bold text-gray-800 mb-3"><i class="fa-solid fa-pen-to-square text-coral-pink mr-2"></i>æ–°å¢/ç·¨è¼¯ä¸€ç­†</h3>
                    <div class="grid gap-3">
                        <div class="flex bg-gray-100 rounded-lg p-1">
                            <label class="flex-1 text-center cursor-pointer">
                                <input type="radio" name="payer" value="ä¿Šå®‰" class="hidden peer" checked>
                                <span class="block py-1.5 text-xs rounded-md text-gray-500 peer-checked:bg-blue-500 peer-checked:text-white transition">ä¿Šå®‰ä»˜</span>
                            </label>
                            <label class="flex-1 text-center cursor-pointer">
                                <input type="radio" name="payer" value="æ¯“èŠ¸" class="hidden peer">
                                <span class="block py-1.5 text-xs rounded-md text-gray-500 peer-checked:bg-pink-500 peer-checked:text-white transition">æ¯“èŠ¸ä»˜</span>
                            </label>
                        </div>
                        
                        <!-- ä»˜æ¬¾æ–¹å¼ -->
                        <div class="flex bg-gray-100 rounded-lg p-1">
                            <label class="flex-1 text-center cursor-pointer">
                                <input type="radio" name="paymentMethod" value="ä¿¡ç”¨å¡" class="hidden peer" checked>
                                <span class="block py-1 text-[10px] rounded-md text-gray-500 peer-checked:bg-slate-700 peer-checked:text-white transition whitespace-nowrap"><i class="fa-regular fa-credit-card mr-1"></i>ä¿¡ç”¨å¡</span>
                            </label>
                            <label class="flex-1 text-center cursor-pointer">
                                <input type="radio" name="paymentMethod" value="ç¾é‡‘" class="hidden peer">
                                <span class="block py-1 text-[10px] rounded-md text-gray-500 peer-checked:bg-orange-500 peer-checked:text-white transition whitespace-nowrap"><i class="fa-solid fa-money-bill-1 mr-1"></i>ç¾é‡‘</span>
                            </label>
                            <label class="flex-1 text-center cursor-pointer">
                                <input type="radio" name="paymentMethod" value="çˆ¸åª½ç¾é‡‘" class="hidden peer">
                                <span class="block py-1 text-[10px] rounded-md text-gray-500 peer-checked:bg-purple-500 peer-checked:text-white transition whitespace-nowrap"><i class="fa-solid fa-hand-holding-dollar mr-1"></i>çˆ¸åª½ç¾é‡‘</span>
                            </label>
                        </div>

                        <div class="flex gap-2">
                            <select id="expense-currency" class="w-[38%] shrink-0 border rounded-lg px-1 py-2 text-xs bg-white">
                                <option value="TWD">TWD å°å¹£</option>
                                <option value="SGD">SGD æ–°å¹£</option>
                                <option value="MYR">MYR é¦¬å¹£</option>
                                <option value="MVR">MVR é¦¬çˆ¾åœ°å¤«</option>
                                <option value="USD">USD ç¾é‡‘</option>
                            </select>
                            <input type="number" id="expense-amount" placeholder="é‡‘é¡" class="flex-1 border rounded-lg px-2 py-2 min-w-0 text-sm">
                        </div>
                        <input type="text" id="expense-item" placeholder="é …ç›® (å¦‚: æ™šé¤ã€Grab)" class="w-full border rounded-lg px-2 py-2 text-sm">
                        <div class="flex gap-2">
                            <select id="expense-cat" class="flex-1 border rounded-lg px-1 py-2 text-xs bg-white">
                                <option value="äº¤é€š">äº¤é€š</option>
                                <option value="é¤é£²">é¤é£²</option>
                                <option value="è³¼ç‰©">è³¼ç‰©</option>
                                <option value="å¨›æ¨‚">å¨›æ¨‚</option>
                                <option value="ä½å®¿">ä½å®¿</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                            <label class="flex items-center justify-center bg-gray-100 text-gray-500 rounded-lg px-2 py-2 cursor-pointer hover:bg-gray-200 w-10 border shrink-0">
                                <i class="fa-solid fa-camera"></i>
                                <input type="file" id="expense-img" accept="image/*" class="hidden">
                            </label>
                        </div>
                        <div id="img-preview-area" class="hidden">
                            <img id="img-preview" src="" class="h-16 w-auto rounded border">
                            <button onclick="clearImage()" class="text-xs text-red-500 ml-2">ç§»é™¤</button>
                        </div>
                        <div class="flex gap-2">
                            <button id="add-expense-btn" onclick="addExpense()" class="flex-1 bg-coral-pink text-white font-bold py-2 rounded-lg hover:bg-red-500 transition shadow-md text-sm">è¨˜å¸³ä¸¦åŒæ­¥è‡³å ±è¡¨</button>
                            <button id="cancel-edit-btn" onclick="cancelEdit()" class="hidden w-16 bg-gray-300 text-gray-700 font-bold py-2 rounded-lg hover:bg-gray-400 transition shadow-md text-sm">å–æ¶ˆ</button>
                        </div>
                    </div>
                </div>
                <!-- Expense History -->
                <div>
                    <div class="flex justify-between items-end mb-2">
                        <h3 class="font-bold text-gray-800">æœ€è¿‘è¨˜å¸³</h3>
                        <button onclick="switchTab('summary')" class="text-xs text-blue-500 underline">æŸ¥çœ‹å®Œæ•´å ±è¡¨</button>
                    </div>
                    <ul id="expense-list" class="space-y-2 pb-10"></ul>
                </div>
            </div>

            <!-- Tab 3: æ”¯å‡ºå½™æ•´è¡¨ (Summary) -->
            <div id="tab-summary" class="tab-content p-4">
                <div class="text-center mb-6">
                    <h2 class="font-serif text-2xl text-palm-green font-bold">æ”¯å‡ºå½™æ•´è¡¨</h2>
                    <div class="h-1 w-16 bg-sand-gold mx-auto mt-2 rounded-full"></div>
                </div>

                <!-- æ–°å¢ï¼šç¾é‡‘éŒ¢åŒ…å€å¡Š -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-4">
                    <div class="p-3 bg-orange-50 border-b border-orange-100 flex justify-between items-center">
                        <h3 class="font-bold text-orange-700"><i class="fa-solid fa-wallet mr-2"></i>ç¾é‡‘éŒ¢åŒ… (é¤˜é¡)</h3>
                    </div>
                    <div class="grid grid-cols-3 divide-x divide-gray-100 p-3 border-b border-gray-100">
                        <div class="text-center">
                            <div class="text-[10px] text-gray-500 mb-1">ç¾é‡‘ USD</div>
                            <div id="wallet-usd" class="font-mono font-bold text-gray-800">150</div>
                        </div>
                        <div class="text-center">
                            <div class="text-[10px] text-gray-500 mb-1">æ–°å¹£ SGD</div>
                            <div id="wallet-sgd" class="font-mono font-bold text-gray-800">200</div>
                        </div>
                        <div class="text-center">
                            <div class="text-[10px] text-gray-500 mb-1">é¦¬å¹£ MYR</div>
                            <div id="wallet-myr" class="font-mono font-bold text-gray-800">600</div>
                        </div>
                    </div>
                    <!-- çˆ¸åª½è´ŠåŠ©å€å¡Š -->
                    <div class="p-3 bg-purple-50 flex justify-between items-center">
                        <div class="flex items-center text-purple-700">
                            <i class="fa-solid fa-hand-holding-heart mr-2"></i>
                            <span class="text-xs font-bold">çˆ¸åª½è´ŠåŠ© (USD)</span>
                        </div>
                        <div id="wallet-parents-usd" class="font-mono font-bold text-purple-700 text-lg">2000</div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-4">
                    <div class="p-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="font-bold text-gray-700"><i class="fa-solid fa-file-invoice-dollar mr-2"></i>é ç®—èˆ‡å¢Šä»˜ç¸½è¦½</h3>
                        <span class="text-xs text-gray-400">å–®ä½: TWD</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full expense-table">
                            <thead>
                                <tr>
                                    <th class="w-[40%]">é …ç›®</th>
                                    <th class="w-[30%]">ä¿Šå®‰</th>
                                    <th class="w-[30%]">æ¯“èŠ¸</th>
                                </tr>
                            </thead>
                            <tbody id="summary-table-body"></tbody>
                            <tfoot class="bg-gray-100 font-bold">
                                <tr>
                                    <td class="p-2 text-center">ç¸½è¨ˆ</td>
                                    <td class="p-2 text-center text-blue-600 whitespace-nowrap" id="total-junan">0</td>
                                    <td class="p-2 text-center text-pink-600 whitespace-nowrap" id="total-yuyun">0</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-4">
                    <h3 class="font-bold text-gray-700 mb-2">çµç®— (å‡åˆ†åˆ¶)</h3>
                    <div class="flex justify-between items-center bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                        <div>
                            <div class="text-xs text-gray-500">ç¸½æ”¯å‡º</div>
                            <div class="font-bold text-lg" id="total-all">0</div>
                        </div>
                        <div class="text-right">
                            <div id="settlement-msg" class="text-sm font-bold text-gray-700">è¨ˆç®—ä¸­...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 4: æ—…éŠæ¸…å–® (Lists) -->
            <div id="tab-lists" class="tab-content p-4">
                <div class="text-center mb-6">
                    <h2 class="font-serif text-2xl text-purple-600 font-bold">è¡Œå‰èˆ‡å‚™å¿˜</h2>
                    <div class="h-1 w-16 bg-sand-gold mx-auto mt-2 rounded-full"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-6">
                    <div class="p-3 bg-purple-50 border-b border-purple-100">
                        <h3 class="font-bold text-purple-700"><i class="fa-solid fa-suitcase mr-2"></i>è¡Œææ¸…å–®</h3>
                    </div>
                    <div id="checklist-container" class="divide-y divide-gray-100"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100 h-full">
                    <h3 class="font-bold text-gray-800 mb-3 border-b pb-2"><i class="fa-regular fa-note-sticky text-yellow-600 mr-2"></i>å‚™å¿˜éŒ„ (è‡ªå‹•å„²å­˜)</h3>
                    <textarea id="memo-area" class="w-full h-40 p-3 bg-yellow-50 rounded-lg border border-yellow-200 text-sm focus:outline-none resize-none text-gray-700" placeholder="è¼¸å…¥å‚™å¿˜äº‹é …æˆ–ç¶²å€..."></textarea>
                    <div id="memo-links" class="mt-2 space-y-1 text-sm"></div>
                </div>
            </div>

            <!-- Tab 5: å¯¦ç”¨è³‡è¨Š (Info) -->
            <div id="tab-info" class="tab-content p-4">
                <div class="text-center mb-6">
                    <h2 class="font-serif text-2xl text-blue-700 font-bold">å¯¦ç”¨è³‡è¨Š</h2>
                    <div class="h-1 w-16 bg-sand-gold mx-auto mt-2 rounded-full"></div>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <a href="https://weather.com/zh-HK/weather/today/l/bfbafb71cea3672231349f36b198478ecc3d5fd524d0918b8051ee838f743675" target="_blank" class="bg-white p-4 rounded-xl shadow-sm text-center border hover:bg-gray-50">
                        <i class="fa-solid fa-cloud-sun-rain text-3xl text-island-blue mb-2"></i>
                        <div class="font-bold text-sm text-gray-700">æ–°åŠ å¡å¤©æ°£</div>
                    </a>
                    <a href="https://weather.com/zh-TW/weather/today/l/Mal%C3%A9+Maldives?placeId=f4d8ca65f3c48dfa3e7c1344d25acbbe716a88e0ae57dfd9b2c5c7c8955b16be" target="_blank" class="bg-white p-4 rounded-xl shadow-sm text-center border hover:bg-gray-50">
                        <i class="fa-solid fa-water text-3xl text-cyan-600 mb-2"></i>
                        <div class="font-bold text-sm text-gray-700">é¦¬çˆ¾åœ°å¤«å¤©æ°£</div>
                    </a>
                    <a href="https://www.msn.com/zh-tw/weather/forecast/in-%E5%90%89%E9%9A%86%E5%9D%A1,%E9%A6%AC%E4%BE%86%E8%A5%BF%E4%BA%9E?loc=eyJsIjoi5ZCJ6ZqG5Z2hIiwiciI6IuWQiemahuWdoSIsImMiOiLppqzkvobopb%2Fkup4iLCJpIjoiTVkiLCJ0IjoxMDIsImciOiJ6aC10dyIsIngiOiIxMDEuNjU1IiwieSI6IjMuMTQ3MiJ9&weadegreetype=C" target="_blank" class="bg-white p-4 rounded-xl shadow-sm text-center border hover:bg-gray-50">
                        <i class="fa-solid fa-sun text-3xl text-orange-600 mb-2"></i>
                        <div class="font-bold text-sm text-gray-700">å‰éš†å¡å¤©æ°£</div>
                    </a>
                    <a href="https://windy.app/zh/forecast2/spot/4723341/Zen+M%C3%B6venpick+Kuredhivaru+" target="_blank" class="bg-white p-4 rounded-xl shadow-sm text-center border hover:bg-gray-50">
                        <i class="fa-solid fa-umbrella-beach text-3xl text-purple-600 mb-2"></i>
                        <div class="font-bold text-sm text-gray-700">è«å‡¡å½¼æ¸¡å‡æ‘å¤©æ°£</div>
                    </a>
                </div>
                <div class="bg-red-50 rounded-xl p-4 mb-4 border border-red-100">
                    <h3 class="font-bold text-red-700 mb-2"><i class="fa-solid fa-phone-volume mr-2"></i>ç·Šæ€¥è¯çµ¡</h3>
                    <ul class="text-sm space-y-2 text-gray-800">
                        <li class="flex justify-between"><span>è­¦å¯Ÿå±€</span> <span class="font-bold">110 / 999</span></li>
                        <li class="flex justify-between"><span>æ•‘è­·è»Š</span> <span class="font-bold">120 / 995</span></li>
                        <li class="flex justify-between"><span>ç«è­¦</span> <span class="font-bold">119 / 995</span></li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-100 mb-6">
                    <h3 class="font-bold text-gray-800 mb-3"><i class="fa-solid fa-bell text-yellow-600 mr-2"></i>å°æé†’</h3>
                    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                        <li><strong>è¡£ç‰©ï¼š</strong>å…¨æ•¸ç‚ºç†±å¸¶æ°£å€™ï¼Œå¸¶å¤å­£è¡£ç‰©ã€‚ä½†å‡ºç™¼/å›ç¨‹å°ç£æ™‚éœ€å‚™ä¸€ä»¶ä¿æš–å¤–å¥—ã€‚</li>
                        <li><strong>é˜²æ›¬ï¼š</strong>é¦¬çˆ¾åœ°å¤«èˆ‡æ–°åŠ å¡ç´«å¤–ç·šå¼·ï¼Œå¿…å‚™å¸½å­ã€å¢¨é¡ã€é˜²æ›¬ä¹³ã€‚</li>
                        <li><strong>æ’åº§ï¼š</strong>æ–°åŠ å¡/é¦¬ä¾†è¥¿äº/é¦¬çˆ¾åœ°å¤«å¤šç‚ºè‹±å¼ä¸‰å­” (Type G)ï¼Œè«‹å¸¶è½‰æ¥é ­ã€‚</li>
                        <li><strong>ç¶²è·¯ï¼š</strong>æå‰è³¼è²· eSIM æˆ–æ¼«éŠã€‚</li>
                    </ul>
                </div>
                <!-- Travel Notices -->
                <div class="space-y-4">
                    <h3 class="font-bold text-gray-800 text-lg mb-2 border-l-4 border-sand-gold pl-2">æ—…ç¨‹æ³¨æ„äº‹é …</h3>
                    <!-- Singapore -->
                    <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-island-blue">
                        <h4 class="font-bold text-island-blue mb-2 flex items-center"><i class="fa-solid fa-city mr-2"></i>æ–°åŠ å¡ (Singapore)</h4>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p class="text-xs text-gray-500">ç¾ä»£åŒ–ã€æ³•è¦åš´æ ¼ã€å¹¾ä¹ç„¡ç¾é‡‘</p>
                            <div class="bg-blue-50 p-2 rounded">
                                <strong class="block text-blue-700 mb-1">ğŸ’³ æ”¯ä»˜æ–¹å¼</strong>
                                <ul class="list-disc list-inside pl-1 text-xs">
                                    <li><strong>é¦–é¸ï¼š</strong>ä¿¡ç”¨å¡ / Apple Pay / Google Pay (åœ°éµå…¬è»Šç›´æ¥åˆ·)ã€‚</li>
                                    <li><strong>æ¬¡é¸ï¼š</strong>ç¾é‡‘ (ç‰›è»Šæ°´/èˆŠå¼é›œè²¨åº—)ã€‚</li>
                                </ul>
                            </div>
                            <div class="bg-blue-50 p-2 rounded">
                                <strong class="block text-blue-700 mb-1">ğŸ’µ ç¾é‡‘å»ºè­° (SGD)</strong>
                                <p class="text-xs">å»ºè­°æ¯å¤©ç´„ $30-$50 (ç´„ NT$700-1,200)ï¼Œæ‡‰æ€¥æˆ–å¹³åƒ¹ç¾é£Ÿç”¨ã€‚</p>
                            </div>
                            <div class="bg-red-50 p-2 rounded border border-red-100">
                                <strong class="block text-red-600 mb-1">âš ï¸ çµ•å°ç¦æ­¢/æ³¨æ„</strong>
                                <ul class="list-disc list-inside pl-1 text-xs space-y-1">
                                    <li>ç¦é£Ÿå£é¦™ç³–ã€åœ°éµå…§åš´ç¦é£²é£Ÿ(å«æ°´)ã€‚</li>
                                    <li>äº‚ä¸Ÿåƒåœ¾ã€éš¨åœ°åç—°ç½°æ¬¾é‡ã€‚</li>
                                    <li>æŠ½è¸åƒ…é™ç‰¹å®šå€åŸŸã€‚</li>
                                    <li><strong>ç¦é…’ä»¤ï¼š</strong>10:30 PM - 7:00 AM å…¬å…±å ´æ‰€ç¦é…’ã€‚</li>
                                    <li><strong>ç©¿è¶Šé¦¬è·¯ï¼š</strong>50må…§æœ‰æ–‘é¦¬ç·š/å¤©æ©‹éœ€ä½¿ç”¨ã€‚</li>
                                    <li>ç¦æ­¢é¤µé£Ÿé‡ç”Ÿå‹•ç‰© (é´¿/çŒ´/è±¬)ã€‚</li>
                                    <li><strong>åš´ç¦é›»å­è¸ï¼š</strong>æŒæœ‰/ä½¿ç”¨çš†é•æ³•ï¼Œç½°æ¬¾é«˜ã€‚</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Maldives -->
                    <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-cyan-500">
                        <h4 class="font-bold text-cyan-600 mb-2 flex items-center"><i class="fa-solid fa-water mr-2"></i>é¦¬çˆ¾åœ°å¤« (Maldives)</h4>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p class="text-xs text-gray-500">ä¸€å³¶ä¸€é£¯åº—ã€ç¾é‡‘ç‚ºä¸»ã€å°è²»æ–‡åŒ–</p>
                            <div class="bg-cyan-50 p-2 rounded">
                                <strong class="block text-cyan-700 mb-1">ğŸ’³ æ”¯ä»˜æ–¹å¼</strong>
                                <ul class="list-disc list-inside pl-1 text-xs">
                                    <li><strong>æ¸¡å‡æ‘ï¼š</strong>ä¿¡ç”¨å¡/ç¾é‡‘ (è¨˜å¸³å¾Œä¸€æ¬¡çµç®—)ã€‚</li>
                                    <li><strong>å±…æ°‘å³¶ï¼š</strong>ç•¶åœ°è²¨å¹£(MVR)/ç¾é‡‘ã€‚é›œè²¨åº—æ”¶ç¾ï¼Œé¤å»³æ”¶å¡ã€‚</li>
                                </ul>
                            </div>
                            <div class="bg-cyan-50 p-2 rounded">
                                <strong class="block text-cyan-700 mb-1">ğŸ’µ ç¾é‡‘å»ºè­° (USD)</strong>
                                <ul class="list-disc list-inside pl-1 text-xs">
                                    <li><strong>å°è²»ï¼š</strong>éœ€å¤§é‡ $1, $5, $10 å°éˆ”ã€‚æ¯å¤©é ç®—ç´„ $10-$20ã€‚</li>
                                    <li><strong>æ³¨æ„ï¼š</strong>ä¸æ”¶èˆŠç‰ˆ/æ±¡æ¼¬/ç ´æç¾é‡‘ï¼Œè«‹æ›æ–°éˆ”ã€‚</li>
                                </ul>
                            </div>
                            <div class="bg-red-50 p-2 rounded border border-red-100">
                                <strong class="block text-red-600 mb-1">âš ï¸ æ³¨æ„äº‹é …</strong>
                                <ul class="list-disc list-inside pl-1 text-xs space-y-1">
                                    <li><strong>å®—æ•™ï¼š</strong>ä¼Šæ–¯è˜­åœ‹å®¶ï¼Œåš´ç¦å¸¶è±¬è‚‰/é…’å…¥å¢ƒã€‚</li>
                                    <li><strong>é£²é…’ï¼š</strong>åƒ…é™æ¸¡å‡æ‘/é…’èˆ¹ï¼›å±…æ°‘å³¶å…¨é¢ç¦é…’ã€‚</li>
                                    <li><strong>æœè£ï¼š</strong>å±…æ°‘å³¶è¡—é“å‹¿ç©¿æ¯”åŸºå°¼ã€‚</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- KL -->
                    <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-orange-500">
                        <h4 class="font-bold text-orange-600 mb-2 flex items-center"><i class="fa-solid fa-mosque mr-2"></i>å‰éš†å¡ (Kuala Lumpur)</h4>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p class="text-xs text-gray-500">å¤šå…ƒæ–‡åŒ–ã€ç¾é‡‘/é›»å­æ”¯ä»˜ä¸¦å­˜ã€æ²»å®‰ç•™æ„</p>
                            <div class="bg-orange-50 p-2 rounded">
                                <strong class="block text-orange-700 mb-1">ğŸ’³ æ”¯ä»˜æ–¹å¼</strong>
                                <ul class="list-disc list-inside pl-1 text-xs">
                                    <li><strong>æ··åˆåˆ¶ï¼š</strong>ç™¾è²¨å¯åˆ·å¡ï¼Œè¡—é‚Š/å¤œå¸‚å¤šæ”¶ç¾é‡‘ (MYR)ã€‚</li>
                                    <li><strong>äº¤é€šå¡ (TNG)ï¼š</strong>æ­æ·é‹å¿…å‚™ã€‚</li>
                                    <li><strong>å«è»Šï¼š</strong>Grab App ç¶å¡ï¼Œé¿å…æ‰¾é›¶/ç¹è·¯ã€‚</li>
                                </ul>
                            </div>
                            <div class="bg-orange-50 p-2 rounded">
                                <strong class="block text-orange-700 mb-1">ğŸ’µ ç¾é‡‘å»ºè­° (MYR)</strong>
                                <p class="text-xs">å»ºè­°æ¯å¤©ç´„ RM150-RM200 (ç´„ NT$1,100-1,500)ã€‚ç¾é‡‘ä½”æ¯”éœ€æ¯”æ–°åŠ å¡é«˜ã€‚</p>
                            </div>
                            <div class="bg-red-50 p-2 rounded border border-red-100">
                                <strong class="block text-red-600 mb-1">âš ï¸ æ³¨æ„äº‹é …</strong>
                                <ul class="list-disc list-inside pl-1 text-xs space-y-1">
                                    <li><strong>æ²»å®‰ï¼š</strong>å°å¿ƒé£›è»Šæ¶åŠ«ï¼ŒåŒ…åŒ…èƒŒå…§å´ï¼Œèµ°è·¯ä¸æ»‘æ‰‹æ©Ÿã€‚</li>
                                    <li><strong>ç¦®å„€ï¼š</strong>é€²æ¸…çœŸå¯ºè„«é‹/ç«¯èŠã€‚å³æ‰‹é€²é£Ÿ/éç‰©ã€‚</li>
                                    <li><strong>æ’åº§ï¼š</strong>240V è‹±å¼ä¸‰å­” (å“å­—å‹)ï¼Œéœ€è½‰æ¥é ­ã€‚</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bg-white border-t border-gray-300 flex justify-around items-center h-16 shrink-0 pb-safe z-20 shadow-[0_-1px_3px_rgba(0,0,0,0.1)]">
            <button onclick="switchTab('plan')" class="nav-btn active flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-island-blue transition-colors" data-target="plan">
                <i class="fa-solid fa-map-location-dot text-xl mb-1"></i>
                <span class="text-[10px] font-medium">è¡Œç¨‹</span>
            </button>
            <button onclick="switchTab('wallet')" class="nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-coral-pink transition-colors" data-target="wallet">
                <i class="fa-solid fa-wallet text-xl mb-1"></i>
                <span class="text-[10px] font-medium">è¨˜å¸³</span>
            </button>
            <button onclick="switchTab('summary')" class="nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-palm-green transition-colors" data-target="summary">
                <i class="fa-solid fa-file-invoice-dollar text-xl mb-1"></i>
                <span class="text-[10px] font-medium">æ”¯å‡ºè¡¨</span>
            </button>
            <button onclick="switchTab('lists')" class="nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-purple-600 transition-colors" data-target="lists">
                <i class="fa-solid fa-list-check text-xl mb-1"></i>
                <span class="text-[10px] font-medium">æ¸…å–®</span>
            </button>
            <button onclick="switchTab('info')" class="nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-blue-700 transition-colors" data-target="info">
                <i class="fa-solid fa-circle-info text-xl mb-1"></i>
                <span class="text-[10px] font-medium">è³‡è¨Š</span>
            </button>
        </nav>
        
        <!-- Delete Confirmation Modal -->
        <div id="delete-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg w-full max-w-xs p-5 transform transition-all scale-100">
                <h3 class="text-lg font-bold text-gray-800 mb-2">ç¢ºèªåˆªé™¤</h3>
                <p class="text-gray-600 text-sm mb-6">ç¢ºå®šè¦åˆªé™¤é€™ç­†è¨˜å¸³è³‡æ–™å—ï¼Ÿ</p>
                <div class="flex gap-3">
                    <button onclick="closeDeleteModal()" class="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button onclick="confirmDelete()" class="flex-1 px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600 transition shadow-sm">åˆªé™¤</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Javascript Logic -->
    <script>
        // --- Data ---
        const itineraryData = [
            {
                day: "Day 1", date: "1/23 (äº”)", loc: "TPE âœˆï¸ SIN",
                timeline: [
                    { time: "04:00", title: "èµ·åºŠç›¥æ´—", desc: "æº–å‚™å‡ºç™¼ï¼" },
                    { time: "04:30", title: "å‰å¾€æ¡ƒåœ’æ©Ÿå ´ T2", desc: "", traffic: "é€æ©Ÿå°ˆè»Š (KKDAY)" },
                    { time: "05:30", title: "Check in & å…ç¨…åº—", desc: "" },
                    { 
                        time: "08:25", 
                        title: "é£›å¾€æ–°åŠ å¡", 
                        desc: "1.æŠµé”å‰ 3 å¤©å…§ä¸Šç¶²å¡«å¯«å¾MyICA Mobileç·šä¸Šå¡«å¯«å…¥å¢ƒå¡ï¼Œå¡«å¥½å¾Œæˆªåœ–QRcode<br>(é…’åº—è¨‚å–®å’Œè¿”ç¨‹æ©Ÿç¥¨è¨‚å–®å°ä¸‹ä¾†å‚™ç”¨)<br>2.æŠµé”æ¨Ÿå®œæ©Ÿå ´(è‡ªå‹•é€šé—œå…¥å¢ƒ)èµ°è‡ªå‹•é€šé“", 
                        traffic: "æ˜Ÿå®‡èˆªç©º JX771" 
                    },
                    { time: "14:30", title: "å‰å¾€é£¯åº—", desc: "", traffic: "æ¥æ©Ÿå°ˆè»Š" },
                    { time: "15:20", title: "Check in", desc: "æ–°åŠ å¡çƒç¯€å…¨å­£é…’åº—", type: "hotel" },
                    { time: "16:00", title: "èŠä½›å£«åŠ & é­šå°¾ç…å…¬åœ’", desc: "", traffic: "åœ°éµ NSç·š", map: "https://maps.app.goo.gl/mVqHQAUdEF8tP15r7" },
                    { time: "17:00", title: "å‰å¾€å…‹æ‹‰ç¢¼é ­", desc: "æ™šé¤: JUwei Nanyang èšå‘³è€å—æ´‹å’–å•¡åº—", link: "https://theju.sg/pages/juwei-nanyang", map: "https://maps.app.goo.gl/6TPiTkmYeKBsurQs6" },
                    { time: "19:00", title: "å…‹æ‹‰ç¢¼é ­éŠèˆ¹", desc: "æŠµé”å…‹æ‹‰ç‘ªé ­å…ˆå»HOOTERSæ—é‚Šçš„æ«ƒå°æ›ç¥¨", map: "https://maps.app.goo.gl/MDrDRhuvaGgCu84v6" },
                    { time: "19:40", title: "å…‹æ‹‰ç¢¼é ­ä¸­å¿ƒé€›é€›", desc: "" },
                    { time: "21:00", title: "å›é£¯åº—", desc: `æ•£æ­¥å»7-11è²·é›¶é£Ÿ&å•¤é…’<br><a href="https://maps.app.goo.gl/syN7ZyM4n7nqJu8fA" target="_blank" class="inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>7-11 åœ°åœ–</a><br>ä½å®¿: <a href='https://maps.app.goo.gl/KZBnjWzNk37gTjfMA' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>æ–°åŠ å¡çƒç¯€å…¨å­£é…’åº—</a>` }
                ]
            },
            {
                day: "Day 2", date: "1/24 (å…­)", loc: "å°å°åº¦ & æ¿±æµ·ç£",
                timeline: [
                    { time: "07:30", title: "èµ·åºŠç›¥æ´—", desc: "" },
                    { time: "08:10", title: "å‰å¾€ äºå¤åŠ æ¤°åå¸", desc: "", map: "https://maps.app.goo.gl/ZBNK5eJP3U7Agf87A" },
                    { time: "08:30", title: "æ—©é¤: äºå¤åŠ æ¤°åå¸", desc: "ç¶“å…¸æ˜Ÿåœ‹æ—©é¤" },
                    { 
                        time: "09:30", 
                        title: "å°å°åº¦ & å“ˆèŠå··", 
                        desc: `<a href="https://maps.app.goo.gl/s24TqWGQup64gWGFA" target="_blank" class="text-blue-600 underline hover:text-blue-800">City Walk</a><br><span class="text-xs text-gray-500 block mt-1 mb-1">éŠç©è·¯ç·š:</span>
                        <a href="https://maps.app.goo.gl/8H3mwVGjvZF49Wjf8" target="_blank" class="route-link">Dunlop street</a> â†’ 
                        <a href="https://maps.app.goo.gl/zQr4YfkUH7xFw8Ys9" target="_blank" class="route-link">Norris Rd</a> â†’ 
                        <a href="https://maps.app.goo.gl/7821xk4QCT2GS1Pw7" target="_blank" class="route-link">Arab St</a> â†’ 
                        <a href="https://maps.app.goo.gl/iERPXKQKnBRGAh4f7" target="_blank" class="route-link">è˜‡ä¸¹å›æ•™å ‚</a> â†’ 
                        <a href="https://maps.app.goo.gl/TE7Som9uU5WjMed36" target="_blank" class="route-link">Bussorah St</a> â†’ 
                        <a href="https://maps.app.goo.gl/LyMxD1hyXRPg9jci7" target="_blank" class="route-link">å“ˆèŠå··</a>`, 
                        traffic: "åœ°éµ NEç·š" 
                    },
                    { time: "11:30", title: "åˆé¤: The Coconut Club", desc: "æ¤°æ¼¿é£¯ååº—(å·²é ç´„11:30)", link: "https://www.thecoconutclub.sg/", map: "https://maps.app.goo.gl/MGoiprWvA898a2u48" },
                    { 
                        time: "13:30", 
                        title: "å‰å¾€ é‡‘æ²™ & æ¿±æµ·ç£èŠ±åœ’", 
                        desc: `<a href="https://maps.app.goo.gl/qhv2XpoAjNncFfNe9" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>æ¿±æµ·ç£èŠ±åœ’</a>`, 
                        traffic: "åœ°éµ DT/CCç·š" 
                    },
                    { 
                        time: "14:00", 
                        title: "éŠè¦½ æ¿±æµ·ç£èŠ±åœ’", 
                        desc: `èŠ±èŠ + é›²éœ§æ—<br>
                        <a href="https://maps.app.goo.gl/dkNCT7mzMTMxpjNN9" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>é›²éœ§æ—</a>
                        <a href="https://maps.app.goo.gl/ApneTJY9CNF8SMbR7" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>èŠ±èŠ</a>`
                    },
                    { time: "16:30", title: "è¿”å›é‡‘æ²™é…’åº—", desc: "" },
                    { time: "17:00", title: "é‡‘æ²™é…’åº—èˆ¢èˆ¨èˆ¹", desc: "" },
                    { time: "17:45", title: "æ™šé¤: Bread Street Kitchen by Gordon Ramsay", desc: "", link: "https://hk.marinabaysands.com/restaurants/bread-street-kitchen.html/?utm_source=google&utm_medium=GMB&utm_campaign=bread_street_kitchen_info_main", map: "https://maps.app.goo.gl/dhhw2GsSdn9vRWRv9" },
                    { time: "19:30", title: "ä¸‹æ¨“å¡ä½ç­‰å™´æ³‰", desc: "" },
                    { 
                        time: "20:00", 
                        title: "é‡‘æ²™è³¼ç‰©ä¸­å¿ƒå™´æ³‰ç‡ˆå…‰ç§€", 
                        desc: "ä½ç½®:é‡‘æ²™è³¼ç‰©å•†åŸå¤–çš„å¯¶é¾åŠæ´»å‹•å»£å ´<br><a href='https://hk.marinabaysands.com/guides/around-mbs/light-and-sound-show.html' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>ç¶²é é€£çµ</a>" 
                    },
                    { time: "20:15", title: "èµ°éå»æ“å¤©æ¨¹ç­‰éŸ³æ¨‚ç‡ˆå…‰ç§€", desc: "", map: "https://maps.app.goo.gl/CiuWWdVg2YPZW62Q8" },
                    { time: "20:45", title: "æ“å¤©æ¨¹éŸ³æ¨‚ç‡ˆå…‰ç§€+æ¥µå…‰ç§€", desc: "" },
                    { time: "21:15", title: "è¿”å›é£¯åº—", desc: "ä½å®¿: æ–°åŠ å¡çƒç¯€å…¨å­£é…’åº—", traffic: "å…¬è»Šæˆ–åœ°éµ" }
                ]
            },
            {
                day: "Day 3", date: "1/25 (æ—¥)", loc: "è–æ·˜æ²™ä¸€æ—¥éŠ",
                timeline: [
                    { time: "08:30", title: "èµ·åºŠç›¥æ´—", desc: "" },
                    { time: "09:30", title: "å‰å¾€ æ€¡è±åŸ", desc: "", map: "https://maps.app.goo.gl/8PoebKzFmDyrAFiZA", traffic: "åœ°éµ NEç·š" },
                    { time: "10:00", title: "æ—©é¤: åå¸å·¥åŠ", desc: "æ€¡è±åŸ", map: "https://maps.app.goo.gl/e6jmt5DxxZ2ydJ7i8" },
                    { 
                        time: "11:00", 
                        title: "å›æ€¡è±åŸ æ­æ·é‹é€²è–æ·˜æ²™ å‰å¾€åå‹ä¸–ç•Œç«™", 
                        desc: "å‡ºç¤ºklook QRcodeæ­ä¹˜<br>ä½ç½®:æ€¡è±åŸ3æ¨“<br><a href='https://kimiyo.tw/sentosa/' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>ç¶²é é€£çµ</a>", 
                        traffic: "åœ°éµè–æ·˜æ²™ç·š" 
                    },
                    { time: "11:30", title: "ç’°çƒå½±åŸé–€å£æ‹ç…§", desc: "", map: "https://maps.app.goo.gl/PvbdMJuwg8An7bZe8" },
                    { 
                        time: "11:40", 
                        title: "è³­å ´+weaveå•†å ´é€›", 
                        desc: `è‚šå­é¤“çš„è©±å¯ä»¥åœ¨é‚£é‚Šè²·å€‹å•¥å¢Šèƒƒ<br>
                        <a href="https://maps.app.goo.gl/sDaRDv3esEyJG6Mo8" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>è³­å ´</a>
                        <a href="https://maps.app.goo.gl/GmV4qB6QKLQdxBnm7" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>weaveå•†å ´</a>` 
                    },
                    { time: "14:00", title: "å¤©éš›ç·šçºœè»Š", desc: "å¾ Beach Station é–‹å§‹", map: "https://maps.app.goo.gl/UDa9cPn4k1W657uy9" },
                    { time: "16:00", title: "å·´æ‹‰ç£æµ·ç˜", desc: "äºæ´²æœ€å—ç«¯ç«‹ç‰Œ", map: "https://maps.app.goo.gl/SvWPx6yLtbTEqsym8" },
                    { time: "17:00", title: "æ™šé¤: Shake Shack", desc: "Sentosa åˆ†åº—", link: "https://www.shakeshack.com.sg/shake-restaurants/sentosa/", map: "https://maps.app.goo.gl/V6WwvX4SEJQA6K4P9" },
                    { 
                        time: "18:30", 
                        title: "è²·å€‹é£²æ–™éå»æ’æ™‚å…‰ä¹‹ç¿¼å…¥å ´", 
                        desc: `LiHO TEA æˆ– Mr. Coconut<br>
                        <a href="https://maps.app.goo.gl/cSptrFfSfTmZeXvL8" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>LiHO</a>
                        <a href="https://maps.app.goo.gl/TxFVhBvLimKAVEnE7" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>Mr. Coconut</a>
                        <a href="https://maps.app.goo.gl/zJhCz2bu3Nds1pyWA" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>æ™‚å…‰ä¹‹ç¿¼</a>` 
                    },
                    { 
                        time: "19:40", 
                        title: "æ™‚å…‰ä¹‹ç¿¼ç…™ç«ç§€", 
                        desc: "<a href='https://retrievertrip.com/%E6%99%82%E5%85%89%E4%B9%8B%E7%BF%BC/#%e6%96%b0%e5%8a%a0%e5%9d%a1%e6%99%82%e5%85%89%e4%b9%8b%e7%bf%bc%e7%b8%bd%e9%95%b7%e6%99%82%e9%96%93' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>ç¶²é é€£çµ</a>"
                    },
                    { time: "20:00", title: "é€›å€‹ç´€å¿µå“åº—å¾Œå›æ€¡è±åŸ", desc: "", traffic: "åœ°éµè–æ·˜æ²™ç·š" },
                    { time: "20:30", title: "æ€¡è±åŸå°é€›", desc: "" },
                    { time: "21:30", title: "å›é£¯åº—", desc: "ä½å®¿:æ–°åŠ å¡çƒç¯€å…¨å­£é…’åº—", traffic: "åœ°éµ NEç·š" }
                ]
            },
            {
                day: "Day 4", date: "1/26 (ä¸€)", loc: "å¸‚å€å·¡ç¦® âœˆï¸ é¦¬çˆ¾åœ°å¤«",
                timeline: [
                    { time: "08:30", title: "èµ·åºŠç›¥æ´—", desc: "" },
                    { time: "09:30", title: "é€€æˆ¿", desc: "è¡Œæå¯„æ”¾é£¯åº—" },
                    { 
                        time: "10:00", 
                        title: "ç¦åº·å¯§å…¬åœ’ & èˆŠç¦§è¡—è­¦å¯Ÿå±€", 
                        desc: `ç¶²ç¾æ‹ç…§é»<br>
                        <a href="https://maps.app.goo.gl/Q6LqqRcG2SQt1T1fA" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>ç¦åº·å¯§å…¬åœ’</a>
                        <a href="https://maps.app.goo.gl/ozrR5qx4N7juHvxo6" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>èˆŠç¦§è¡—è­¦å¯Ÿå±€</a>`
                    },
                    { time: "11:30", title: "å‰å¾€ ç‰›è»Šæ°´", desc: "", map: "https://maps.app.goo.gl/ZAw3KSMcmVgihSHa7", traffic: "å…¬è»Šæˆ–åœ°éµ" },
                    { 
                        time: "11:50", 
                        title: "åˆé¤: äº†å‡¡æ²¹é›é£¯â€§éºµ", 
                        desc: "", 
                        map: "https://maps.app.goo.gl/AfBdWA1sDVYXJhxN9" 
                    },
                    { 
                        time: "12:50", 
                        title: "ç‰›è»Šæ°´é€›é€›", 
                        desc: "å¯ä»¥å»ä¸€ä¸‹ç´€å¿µå“åº— Singapore Gift Gate<br><a href='https://maps.app.goo.gl/DitKbuKHzWjLuJLv5' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'><i class='fa-solid fa-map-location-dot mr-1'></i>Singapore Gift Gate åœ°åœ–</a>" 
                    },
                    { time: "14:00", title: "è¿”å›é£¯åº—æ‹¿è¡Œæ", desc: "", traffic: "åœ°éµ NEç·š" },
                    { 
                        time: "14:30", 
                        title: "å‰å¾€ æ¨Ÿå®œæ©Ÿå ´ ç¬¬äºŒèˆªå»ˆ", 
                        desc: "å‰ä¸€æ™šä¸Šå…ˆä¸Šç¶²å¡«å¯«å…¥å¢ƒè¡¨ ï¼Œå–å¾—é›»å­ç™»æ©Ÿè­‰", 
                        traffic: "é€æ©Ÿå°ˆè»Š" 
                    },
                    { 
                        time: "15:00", 
                        title: "æå‰è¾¦ç†æ‰˜é‹è¡Œæ", 
                        desc: "åˆ°T2 çš„ Row 5 æˆ– Row 6ï¼ˆæ–°èˆªçš„è‡ªåŠ©å°ˆå€ï¼‰ï¼Œæ‰¾ Kiosk æ©Ÿå°æƒæè­·ç…§æˆ–é›»å­ç™»æ©Ÿè­‰æ‰˜é‹è¡Œæ" 
                    },
                    { 
                        time: "15:30", 
                        title: "æ¨Ÿå®œæ©Ÿå ´ èµ°èµ°æ™ƒæ™ƒ", 
                        desc: `<strong>T2èˆªç«™:</strong><br>
                        2F å…¥å¢ƒ Public å€: 3Då®¤å…§ç€‘å¸ƒ (Gate 6-7ä¸­é–“)<br>
                        2F: å…è²» Skytrain (T2å¾€T3ï¼Œé å·¦çª—æ‹æ”)<br><br>
                        <strong>T3èˆªç«™:</strong><br>
                        1F: å…è²»æºœæ»‘æ¢¯ (12:00-22:30, ä¸‹è¼‰è¨»å†ŠChangi Appå¾Œåœ¨æœå‹™å°å‡ºç¤ºæœƒå“¡QRcodeå…Œæ›10æ¬¡å…è²»æºœæ»‘æ¢¯ , å…¥å£åœ¨1F, æœå‹™å°åœ¨B2)<br>
                        2F/3F: è´è¶åœ’ (Butterfly Garden)<br><br>
                        <strong>JEWEL æ˜Ÿè€€æ¨Ÿå®œ (T1):</strong><br>
                        B2-L5: ç€‘å¸ƒ (Rain Vortex)<br>
                        5F: æ˜Ÿç©ºèŠ±åœ’ (éœ€é–€ç¥¨)`
                    },
                    { time: "19:40", title: "Check IN å‡ºå¢ƒ", desc: "" },
                    { 
                        time: "20:40", 
                        title: "é£›å¾€é¦¬çˆ¾åœ°å¤«", 
                        desc: "èˆªç­æŠµé”å‰ 96 å°æ™‚å…§ä¸Šç¶²å¡«å¯«å…¥å¢ƒè¡¨<br><a href='https://imuga.immigration.gov.mv/' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200 mr-2'>å…¥å¢ƒè¡¨é€£çµ</a><a href='https://www.stan-travel.com/imuga-maldives-immigration/' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>å¡«å¯«æ•™å­¸é€£çµ</a>",
                        traffic: "æ–°èˆª SQ 438" 
                    },
                    { time: "01:15", title: "æŠµé”é¦¬çˆ¾åœ°å¤«", desc: "" },
                    { time: "02:15", title: "å‰å¾€ éå¢ƒæ—…é¤¨", desc: "ä½å®¿: 78 Veli", traffic: "å°ˆè»Šæ¥é€" }
                ]
            },
            {
                day: "Day 5", date: "1/27 (äºŒ)", loc: "é¦¬çˆ¾åœ°å¤« Kuredhivaru",
                timeline: [
                    { time: "Morning", title: "å‰å¾€æ°´é£›æ©Ÿå ´", desc: "", traffic: "å°ˆè»Šæ¥é€" },
                    { time: "Check-in", title: "MÃ¶venpick Resort Kuredhivaru", desc: "äººé–“å¤©å ‚é–‹å§‹ï¼<br>30åˆ†é˜æ”å½±(å«æ‰“å°ä¸€å¼µç…§ç‰‡)", type: "hotel", traffic: "æ°´ä¸Šé£›æ©Ÿ" },
                    { time: "12:00-16:00", title: "Lunch", desc: "BODUMAS æ—¥æ–™" },
                    { time: "16:00-17:00", title: "ONU Marche - Chocolate Hour", desc: "" },
                    { time: "19:00-22:00", title: "Dinner", desc: "ONU Marche - International Buffet" }
                ]
            },
            {
                day: "Day 6", date: "1/28 (ä¸‰)", loc: "äº«å—åº¦å‡æ‘è¨­æ–½",
                timeline: [
                    { time: "07:00-11:00", title: "Breakfast", desc: "ONU Marche" },
                    { time: "10:00-11:00", title: "60åˆ†é˜SPA(éœ€äº‹å…ˆé ç´„)", desc: "30åˆ†é˜å‡ç´š60åˆ†é˜ $80/per person" },
                    { time: "12:00-16:00", title: "Lunch", desc: "LATITUDE 5.5 ç‡’çƒ¤" },
                    { time: "16:00-17:00", title: "ONU Marche - Chocolate Hour", desc: "" },
                    { time: "17:00-19:00", title: "è½æ—¥æ°´ç…™(éœ€äº‹å…ˆé ç´„)", desc: "$120/per couple" },
                    { time: "19:00-22:00", title: "Dinner", desc: "ONU Marche - Welcome to Jungle" }
                ]
            },
            {
                day: "Day 7", date: "1/29 (å››)", loc: "äº«å—åº¦å‡æ‘è¨­æ–½",
                timeline: [
                    { time: "07:00-11:00", title: "Breakfast", desc: "ONU Marche" },
                    { time: "12:00-16:00", title: "Lunch", desc: "BODUMAS æ—¥æ–™" },
                    { time: "16:00-17:00", title: "ONU Marche - Chocolate Hour", desc: "" },
                    { time: "16:30-19:30", title: "Local Island Visit(éœ€äº‹å…ˆé ç´„)", desc: "" },
                    { time: "19:00-22:00", title: "Dinner", desc: "ONU Marche -Dacha Night" }
                ]
            },
            {
                day: "Day 8", date: "1/30 (äº”)", loc: "äº«å—åº¦å‡æ‘è¨­æ–½",
                timeline: [
                    { time: "07:00-11:00", title: "Breakfast", desc: "æ¼‚æµ®æ—©é¤" },
                    { time: "12:00-16:00", title: "Lunch", desc: "LATITUDE 5.5 ç‡’çƒ¤" },
                    { time: "16:00-17:00", title: "ONU Marche - Chocolate Hour", desc: "" },
                    { time: "18:30-20:30", title: "Sunset Fishing(éœ€äº‹å…ˆé ç´„)", desc: "" },
                    { time: "19:00-22:00", title: "Dinner", desc: "ONU Marche - Mediterranean Night" }
                ]
            },
            {
                day: "Day 9", date: "1/31 (å…­)", loc: "é¦¬çˆ¾åœ°å¤« âœˆï¸ å‰éš†å¡",
                timeline: [
                    { time: "07:00-11:00", title: "Breakfast", desc: "ONU Marche" },
                    { time: "12:00-16:00", title: "Lunch", desc: "BODUMAS æ—¥æ–™ or LATITUDE 5.5 ç‡’çƒ¤" },
                    { time: "16:00", title: "é›¢é–‹æ¸¡å‡æ‘", desc: "å‰å¾€é¦¬åˆ—å±…æ°‘å³¶", traffic: "æ°´ä¸Šé£›æ©Ÿ" },
                    { time: "18:00", title: "å‰å¾€é¦¬åˆ—æ©Ÿå ´", desc: "", traffic: "å°ˆè»Šæ¥é€" },
                    { time: "21:15", title: "é£›å¾€å‰éš†å¡", desc: "", traffic: "äºæ´²èˆªç©º AK73" }
                ]
            },
            {
                day: "Day 10", date: "2/01 (æ—¥)", loc: "å‰éš†å¡å¸‚å€",
                timeline: [
                    { 
                        time: "04:50", 
                        title: "æŠµé”å‰éš†å¡", 
                        desc: "1.æŠµé”å‰ 3 å¤©å…§ä¸Šç¶²å¡«å¯«MDAC é›»å­å…¥å¢ƒå¡ï¼Œå¡«å¥½å¾Œä¸‹è¼‰ä¸‹ä¾†<br>(é…’åº—è¨‚å–®å’Œè¿”ç¨‹æ©Ÿç¥¨è¨‚å–®å°ä¸‹ä¾†å‚™ç”¨)<br>2.æŠµé”å‰éš†å¡æ©Ÿå ´(è‡ªå‹•é€šé—œå…¥å¢ƒ)èµ°è‡ªå‹•é€šé“<br><a href='https://imigresen-online.imi.gov.my/mdac/main' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200 mr-2'>MDACé€£çµ</a><a href='https://couplehuang.com/malaysia_mdac_request_kul_airport/' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>å¡«å¯«æ­¥é©Ÿ&å…¥å¢ƒæ•™å­¸</a>" 
                    },
                    { time: "06:00", title: "æ—©é¤: è¯é™½å†°å®¤", desc: "", map: "https://maps.app.goo.gl/AnDgXBimjYUB73nX7" },
                    { time: "07:30", title: "å‰å¾€é£¯åº—å¯„æ”¾è¡Œæ", desc: "é£¯åº—å¯„æ”¾è¡Œæ&åä¸€ä¸‹", traffic: "æ¥æ©Ÿå°ˆè»Š" },
                    { time: "09:00", title: "å‰å¾€ é»‘é¢¨æ´é®", desc: "", traffic: "Grab", map: "https://maps.app.goo.gl/1TToUK8biMQ4deGR8" },
                    { time: "09:30", title: "é»‘é¢¨æ´éŠè¦½", desc: "å·¨å‹é‡‘ä½›å»£å ´ã€å½©è™¹éšæ¢¯ã€ä¸»æ´ç¥å»Ÿã€æ´ç©´æ¢éšªã€è—è¡“æ´ç©´ã€æ‘©ç¾…æ´" },
                    { time: "12:30", title: "å‰å¾€ æŸå¨å¹´å»£å ´", desc: "", traffic: "Grab", map: "https://maps.app.goo.gl/cDRn7imYFY5HBYfS8" },
                    { time: "13:00", title: "æŸå¨å¹´å»£å ´é€›åƒ", desc: "" },
                    { time: "16:00", title: "å›é£¯åº—ä¼‘æ¯ä¸€ä¸‹", desc: "" },
                    { time: "17:30", title: "å‰å¾€åŸä¸­åŸå…¬åœ’", desc: "", map: "https://maps.app.goo.gl/Ph4MrX6pMB9ZJPpN6" },
                    { time: "17:45", title: "åŸä¸­åŸå…¬åœ’é€›é€›", desc: "" },
                    { time: "18:15", title: "å‰éš†å¡åœ‹æ²¹é›™å³°å¡” åƒè§€", desc: "18:15é›†åˆï¼Œ18:30é–‹å§‹åƒè§€", map: "https://maps.app.goo.gl/bVZX53xTBqtjEiM59" },
                    { time: "19:15", title: "KLCCé€›åƒ", desc: "", map: "https://maps.app.goo.gl/19X67w2SnVLhCouVA" },
                    { 
                        time: "21:15", 
                        title: "å›é£¯åº—", 
                        desc: `ä½å®¿: <a href='https://maps.app.goo.gl/CvhEu5XXgtChCFEE9' target='_blank' class='inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200'>æ´»æ¨‚é…’åº—</a><br>
                        <div class="mt-2 pt-2 border-t border-gray-200">
                            <span class="text-xs font-bold text-gray-700">å¦‚æœé‚„æœ‰é«”åŠ›å¯ä»¥å»é»ƒäºè¯å°åƒåº—åƒå®µå¤œ</span><br>
                            <span class="text-xs text-gray-500">æ¨è–¦å¿…é»: å¥¶æ²¹è¦ã€æ²™å—²è‚‰ä¸²ã€é¹¹è›‹é»ƒé­·é­šã€é›ç¿…ã€ç‚’è²æ®¼ã€çƒ¤é­”é¬¼é­š</span><br>
                            <a href="https://maps.app.goo.gl/cfTmu4SAR5WsM5ky9" target="_blank" class="inline-block mt-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>é»ƒäºè¯å°åƒåº—åœ°åœ–</a>
                        </div>`, 
                        type: "hotel" 
                    }
                ]
            },
            {
                day: "Day 11", date: "2/02 (ä¸€)", loc: "å‰éš†å¡æ–‡åŒ–å·¡ç¦®",
                timeline: [
                    { time: "08:30", title: "èµ·åºŠç›¥æ´—", desc: "" },
                    { time: "09:30", title: "å‰å¾€ æºæ˜Œéš†å’–å•¡åº—", desc: "", traffic: "åœ°éµ KGLç·š", map: "https://maps.app.goo.gl/nrzNxuqUhDRyJHAZ9" },
                    { time: "10:00", title: "æ—©é¤: æºæ˜Œéš†å’–å•¡åº—", desc: "éœ€æ’éšŠ" },
                    { 
                        time: "11:00", 
                        title: "èŒ¨å» è¡— Citywalk", 
                        desc: `éŠç©è·¯ç·š:<br>
                        <a href="https://maps.app.goo.gl/LUfpMnfout31oiMa9" target="_blank" class="route-link">é¬¼ä»”å··</a> â†’ 
                        <a href="https://maps.app.goo.gl/K53Za11DjaAr1gj69" target="_blank" class="route-link">é¦¬é‡Œå®‰æ›¼èˆˆéƒ½å»Ÿ</a> â†’ 
                        <a href="https://maps.app.goo.gl/ye4Eh5J2ZAGLbJD47" target="_blank" class="route-link">èŒ¨å» è¡—å¸‚å ´</a> â†’ 
                        <a href="https://maps.app.goo.gl/354H2uZTYTsDbFAt6" target="_blank" class="route-link">REXKL</a> â†’ 
                        <a href="https://maps.app.goo.gl/W5iNb896njK9ukab7" target="_blank" class="route-link">Jimmys Ice Cream</a> â†’ 
                        <a href="https://maps.app.goo.gl/puejDvVgZ7CDzgQW6" target="_blank" class="route-link">ç¾…æ¼¢æœé¾çœ¼å†°ç³–ç‡‰å†¬ç“œ</a> â†’ 
                        <a href="https://maps.app.goo.gl/rB7UgUjd9MbS3mrd8" target="_blank" class="route-link">ç¾©æ¬½è±†è…èŠ±/è±†æ¼¿æ°´</a> â†’ 
                        <a href="https://maps.app.goo.gl/5PmcVh1gihLsoSx67" target="_blank" class="route-link">Madam Tang Machi Popo</a> â†’ 
                        <a href="https://maps.app.goo.gl/5p9ysKtGAYTAM3Xv5" target="_blank" class="route-link">ä¸­å¤®å¸‚å ´</a> â†’ 
                        <a href="https://maps.app.goo.gl/zqrf34Vk86MbWbxD6" target="_blank" class="route-link">I Love KL Statue</a> â†’ 
                        <a href="https://maps.app.goo.gl/rmEoMPsgLJbnQWKu5" target="_blank" class="route-link">River of Life</a> â†’ 
                        <a href="https://maps.app.goo.gl/yEvBgpQdtKkH62gm9" target="_blank" class="route-link">ç¨ç«‹å»£å ´</a> â†’ 
                        <a href="https://maps.app.goo.gl/FFUUQghXWfbLKQKc6" target="_blank" class="route-link">å ç¾å›æ•™å ‚</a>`
                    },
                    { time: "14:00", title: "å‰å¾€ æ•¦æ‹‰è–©åœ‹éš›è²¿æ˜“è³¼ç‰©å¤©å ‚", desc: "", traffic: "Grab", map: "https://maps.app.goo.gl/5cpmU8RhhfUmfiMH8" },
                    { time: "14:30", title: "ä¸‹åˆèŒ¶: æµ·è…³äºº", desc: "", map: "https://maps.app.goo.gl/UrfHGMDPJ1kGyfmF9" },
                    { time: "15:30", title: "æ•¦æ‹‰è–©åœ‹éš›è²¿æ˜“è³¼ç‰©å¤©å ‚ é€›é€›", desc: "" },
                    { time: "17:30", title: "å›æ­¦å‰å…ç™»", desc: "", map: "https://maps.app.goo.gl/SWAVvULFtTPZTg4d8" },
                    { 
                        time: "17:45", 
                        title: "æ­¦å‰å…ç™»ä¸€å¸¶é€›è¡—", 
                        desc: `<a href="https://maps.app.goo.gl/TdmHQVhfbXLjVUVb9" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>åŠ‰è¶å»£å ´</a>
                        <a href="https://maps.app.goo.gl/TpKjA6ZyrY7D6swx5" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>æ¨‚å¤©å»£å ´</a>
                        <a href="https://maps.app.goo.gl/8E1GxdJtuXLScaSW9" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>éº¥ç•¶å‹</a>`
                    },
                    { 
                        time: "19:00", 
                        title: "äºç¾…è¡—å¤œå¸‚", 
                        desc: `<a href="https://maps.app.goo.gl/EufgWQwrE2GsnobK7" target="_blank" class="inline-block mb-2 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>äºç¾…è¡—å¤œå¸‚åœ°åœ–</a><br>
                        æ¨è–¦åº—å®¶:<br>
                        <a href="https://maps.app.goo.gl/AyzdxhYmhjSFrqi69" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>TG's Bistro</a>
                        <a href="https://maps.app.goo.gl/EYRd3jRejDCCH7Dt5" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>MAMAM Place æ¦´æ§¤ç”œé»</a>
                        <a href="https://maps.app.goo.gl/UsGQgXxu2dbD2t4GA" target="_blank" class="inline-block mt-1 mr-1 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>æ˜è¨˜ç‡’é­šç¾å‘³åº—</a>`
                    },
                    { time: "21:00", title: "å›é£¯åº—", desc: "ä½å®¿: æ´»æ¨‚é£¯åº—" }
                ]
            },
            {
                day: "Day 12", date: "2/03 (äºŒ)", loc: "KUL âœˆï¸ TPE",
                timeline: [
                    { time: "08:30", title: "èµ·åºŠç›¥æ´—", desc: "" },
                    { time: "09:30", title: "å‰å¾€ æ–°å³°è‚‰éª¨èŒ¶", desc: "", map: "https://maps.app.goo.gl/e8hcgx6XDgqNXAxG8" },
                    { time: "09:45", title: "æ—©é¤: æ–°å³°è‚‰éª¨èŒ¶", desc: "" },
                    { time: "10:45", title: "å›é£¯åº—", desc: "æ•´ç†è¡Œæä¼‘æ•´" },
                    { time: "11:00", title: "å½ˆæ€§æ™‚é–“", desc: "" },
                    { time: "12:00", title: "å‰å¾€å‰éš†å¡æ©Ÿå ´ T1", desc: "", traffic: "é€æ©Ÿå°ˆè»Š" },
                    { time: "13:00", title: "Check in", desc: "" },
                    { time: "15:25", title: "é£›å¾€ æ¡ƒåœ’æ©Ÿå ´ T2", desc: "", traffic: "é•·æ¦®èˆªç©º BR228" },
                    { time: "20:05", title: "å…¥å¢ƒå°ç£", desc: "ç”œèœœçš„å®¶" },
                    { time: "21:30", title: "å‰å¾€ æ±æ—¥å•†åº—", desc: "", traffic: "æ¥æ©Ÿå°ˆè»Š" }
                ]
            }
        ];

        const checklistData = [
            {
                id: "common",
                title: "å…±åŒé …ç›®",
                icon: "fa-suitcase-rolling",
                color: "text-blue-600",
                bg: "bg-blue-50",
                items: [
                    { 
                        cat: "é‡è¦è­‰ä»¶èˆ‡é‡‘æµ", 
                        list: ["è­·ç…§ (æœ‰æ•ˆæœŸé™>6å€‹æœˆ)", "å…ç°½è­‰ç”³è«‹ (æ˜Ÿ/é¦¬/é¦¬çˆ¾åœ°å¤«)", "éŒ¢åŒ…ã€ä¿¡ç”¨å¡", "ç¾é‡‘ (æ–°å¹£ã€ç¾é‡‘ã€é¦¬å¹£)"] 
                    },
                    { 
                        cat: "3C èˆ‡æ”å½±", 
                        list: ["æ‰‹æ©Ÿ", "æ‰‹éŒ¶", "SIM å¡ (ä¸‰åœ‹)", "è¡Œå‹•é›»æºã€è±†è…é ­ã€å……é›»ç·šã€è½‰æ¥å™¨", "ç›¸æ©Ÿ (é›»æ± ã€è¨˜æ†¶å¡ã€è®Šç„¦/å®šç„¦é¡é ­å„ä¸€)ã€è…³æ¶ã€åæŒ¯é¡"] 
                    },
                    { 
                        cat: "ç”Ÿæ´»èˆ‡è—¥å“", 
                        list: ["è—¥å“ (æ­¢ç—›/æ­¢ç€‰/è…¸èƒƒ/æ„Ÿå†’/æšˆèˆ¹è—¥/è”“è¶Šè“/ç›Šç”ŸèŒ/è„¹æ°£è—¥)", "ç›¥æ´—ç”¨å“ (ç‰™åˆ·/ç‰™è†/æ¯›å·¾/é™¤æ¯›/æ²æµ´ä¹³/æ´—é«®ä¹³/æ´—é¢ä¹³)", "é˜²æ›¬ä¹³ã€é˜²æ›¬æ³¥", "å¢¨é¡ã€çœ¼é¡ç›’", "é ¸æ•", "æ´—è¡£ç²¾", "æ¯›å·¾*2", "é›¨å‚˜", "é˜²èšŠæ¶²"] 
                    },
                    { 
                        cat: "æ°´ä¸Šæ´»å‹•", 
                        list: ["æ¸¸æ³³åœˆ*2", "å®‰å…¨ç¹© (æ°´å±‹æµ®æ½›ç”¨)", "æµ®æ½›é¢é¡ã€æ¼‚æµ®è¢‹", "æ¸¸æ³³é˜²æ°´åŒ…ã€æ‰‹æ©Ÿé˜²æ°´è¢‹"] 
                    }
                ]
            },
            {
                id: "yuyun",
                title: "æ¯“èŠ¸",
                icon: "fa-person-dress",
                color: "text-pink-500",
                bg: "bg-pink-50",
                items: [
                    { 
                        cat: "ç¾å¦èˆ‡éš±çœ¼", 
                        list: ["åŒ–å¦åŒ…ã€åˆ·å…·åŒ…", "å¸å¦æ°´ã€å¸å¦æ£‰", "æ´—è‡‰å·¾*12", "éš±å½¢çœ¼é¡(ç¾ç³+é€æ˜)", "éš±å½¢çœ¼é¡ä¿é¤Šæ¶²ã€ç”Ÿç†é£Ÿé¹½æ°´"] 
                    },
                    { 
                        cat: "åº¦å‡ç©¿æ­", 
                        list: ["DAY1 è—é’ä¸­å¼+è—é’å°å¤–å¥—+æ­²æ­²å¹³å®‰é …éŠ", "DAY2 è™ç¾äºº+åŠèº«è£™", "DAY3 è—è‰²åº¦å‡é€£èº«çŸ­è¤²", "DAY4 è—è‰²åŠå¸¶è£™å¥—è£+è´è¶ç´”éŠ€é …éŠ", "DAY5-8 é»ƒè‰²é•·è£™+é»ƒè‰²ç¶²ç´—è€³å¤¾", "DAY5-8 å¤¢è¯éŒ„+ç¶ è´è¶è€³ç’°+èŠå‘¨å¤¢è¶é …éŠ", "DAY9 WANGXO æ£•è‰²é•·è£™+è…°éŠ+æ£•é‡‘çç è€³å¤¾", "DAY10 è—é’ä¸­å¼+è—é’å°å¤–å¥—+æ­²æ­²å¹³å®‰é …éŠ", "DAY11 è—è‰²åŠå¸¶è£™å¥—è£+è´è¶ç´”éŠ€é …éŠ", "DAY12 è—è‰²åº¦å‡é€£èº«çŸ­è¤²", "å…§è¡£*6ã€nubraã€å…æ´—å…§è¤²*12ã€è¥ªå­*10", "è€³ç’°ã€é …éŠ"] 
                    },
                    { 
                        cat: "æ³³è¡£èˆ‡æ½›æ°´", 
                        list: ["ç´«è‰²æ¯”åŸºå°¼å¥—è£", "æ£•è‰²æ¯”åŸºå°¼å¥—è£", "è½æ—¥é¤˜æš‰æ¯”åŸºå°¼å¥—è£", "wave shineé€£é«”æ¯”åŸºå°¼", "airspace é€£é«”æ¯”åŸºå°¼", "æ°´æ¯è¡£+æ°´æ¯é•·è¤²", "æ½›æ°´è¥ªã€æ½›æ°´æ‰‹å¥—ã€æ½›æ°´å¸½", "æ¯›å·¾è¡£ 2ä»¶", "é˜²æ›¬è¡£ã€é˜²æ›¬æ‰‹å¥—", "æ³³è¡£æ‰“åº•å…§è¤²*5"] 
                    },
                    { 
                        cat: "é‹å¸½ç¡è¡£", 
                        list: ["æ‹–é‹1é›™ã€æ¶¼é‹1é›™", "å¸ƒé‹1é›™", "è‰å¸½2é ‚", "ç¡è¡£2å¥—"] 
                    }
                ]
            },
            {
                id: "junan",
                title: "ä¿Šå®‰",
                icon: "fa-person",
                color: "text-blue-500",
                bg: "bg-blue-50",
                items: [
                    { 
                        cat: "åº¦å‡ç©¿æ­", 
                        list: [
                            "DAY1 è—é’é•·è¢–è¥¯è¡«+ç™½è‰²çŸ­è¤²",
                            "DAY2 å¡å…¶é•·è¢–è¥¯è¡«+è¥¿è£ç°è‰²é•·è¤²",
                            "DAY3 å·¥è£ç°è‰²è¥¯è¡«+å¡å…¶é•·è¤²",
                            "DAY4 è—è‰²çŸ­è¢–èŠ±è¥¯è¡«+è¥¿è£é»‘è‰²é•·è¤²",
                            "DAY5-8 é»ƒè‰²çŸ­è¢–è¥¯è¡«+é»‘è‰²çŸ­è¤²",
                            "DAY5-8 æ–°ä¸­å¼çŸ­è¢–è¥¯è¡«+è»ç¶ çŸ­è¤²",
                            "DAY9 å¡å…¶é•·è¢–è¥¯è¡«+è¥¿è£é»‘è‰²é•·è¤²",
                            "DAY10 è—é’é•·è¢–è¥¯è¡«+ç™½è‰²çŸ­è¤²",
                            "DAY11 è—è‰²çŸ­è¢–èŠ±è¥¯è¡«+è¥¿è£é»‘è‰²é•·è¤²",
                            "DAY12 å·¥è£ç°è‰²è¥¯è¡«+å¡å…¶é•·è¤²",
                            "çŸ­è¢–T * 5 / èƒŒå¿ƒ*2",
                            "ç¡è¡£*2 å¥—",
                            "è¥ªå­*8å¥—",
                            "ä»²é–“é …éŠ"
                        ] 
                    },
                    { 
                        cat: "æ³³è¡£èˆ‡æ½›æ°´", 
                        list: ["çŸ­æ³³è¤²*1", "æ‹‰éŠæ°´æ¯è¡£*1ã€æ°´æ¯è¡£*1", "è¡æµªçŸ­è¤²*2", "æµ®æ½›å¸½*1ã€æµ®æ½›é¢é¡*1"] 
                    },
                    { 
                        cat: "é‹å¸½èˆ‡é›œé …", 
                        list: ["åŒ—è‡‰æ‹–é‹*1", "é´¨èˆŒå¸½*1", "è¡Œæç§¤é‡å™¨"] 
                    }
                ]
            }
        ];

        // --- Summary Data (From Image) ---
        const initialSummaryData = [
            { cat: "æ©Ÿç¥¨", item: "æ˜Ÿå®‡ å°ç£ -> æ–°åŠ å¡", junan: 12400, yuyun: 0 },
            { cat: "æ©Ÿç¥¨", item: "æ–°èˆª æ–°åŠ å¡ -> é¦¬çˆ¾åœ°å¤«", junan: 26465, yuyun: 0 },
            { cat: "æ©Ÿç¥¨", item: "äºèˆª é¦¬çˆ¾åœ°å¤« -> å‰éš†å¡", junan: 15469, yuyun: 0 },
            { cat: "æ©Ÿç¥¨", item: "é•·æ¦® å‰éš†å¡ -> å°ç£", junan: 13949, yuyun: 0 },
            { cat: "åº¦å‡æ‘", item: "è«å‡¡æ¯” + éå¢ƒæ—…é¤¨ (å‡ç´šAI+1è¬)", junan: 60000, yuyun: 141000 },
            { cat: "é…’åº—", item: "æ–°åŠ å¡ (å…¨å­£é…’åº—-3æ™š)", junan: 13777, yuyun: 0 },
            { cat: "é…’åº—", item: "å‰éš†å¡ (2æ™š)", junan: 0, yuyun: 0 },
            { cat: "äº¤é€š", item: "é€æ©Ÿå°ˆè»Š: æ–°åŸ” -> æ¡ƒåœ’2èˆª", junan: 1496, yuyun: 0 },
            { cat: "äº¤é€š", item: "æ¥æ©Ÿå°ˆè»Š: æ¡ƒæ©Ÿ2èˆª -> æ–°åŸ”", junan: 1430, yuyun: 0 },
            { cat: "äº¤é€š", item: "æ˜Ÿ/é¦¬ æ©Ÿå ´é£¯åº—æ¥é€ (å…±4è¶Ÿ)", junan: 0, yuyun: 4085 },
            { cat: "ç¶²è·¯", item: "SIM å¡ (æ˜Ÿé¦¬-åƒåˆ°é£½)", junan: 1161, yuyun: 0 },
            { cat: "ç¶²è·¯", item: "SIM å¡ (é¦¬çˆ¾åœ°å¤«5æ—¥-17G)", junan: 1399, yuyun: 0 },
            { cat: "ä¿éšª", item: "æ–°åŠ å¡+é¦¬çˆ¾åœ°å¤«+å‰éš†å¡(12æ—¥)", junan: 0, yuyun: 5354 },
            { cat: "å¨›æ¨‚", item: "é‡‘æ²™é…’åº—èˆ¢èˆ¨èˆ¹", junan: 0, yuyun: 487 },
            { cat: "å¨›æ¨‚", item: "å¤©éš›ç·šçºœè»Š", junan: 0, yuyun: 1763 },
            { cat: "å¨›æ¨‚", item: "æ™‚å…‰ä¹‹ç¿¼ç…™ç«ç§€", junan: 0, yuyun: 1190 },
            { cat: "å¨›æ¨‚", item: "å‰éš†å¡åœ‹æ²¹é›™å³°å¡”é–€ç¥¨", junan: 0, yuyun: 2448 },
            { cat: "å¨›æ¨‚", item: "æ–°åŠ å¡å…‹æ‹‰ç‘ªé ­éŠèˆ¹", junan: 0, yuyun: 1164 },
            { cat: "äº¤é€š", item: "è–æ·˜æ²™æ·é‹ç¥¨", junan: 0, yuyun: 202 }
        ];

        // --- Logic ---

        // Tab Switching
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('text-island-blue', 'text-palm-green', 'text-coral-pink', 'text-purple-600', 'text-blue-700', 'active-nav');
                el.classList.add('text-gray-500');
            });

            const btn = document.querySelector(`.nav-btn[data-target="${tabId}"]`);
            btn.classList.remove('text-gray-500');
            
            const colorMap = {
                'plan': 'text-island-blue',
                'summary': 'text-palm-green',
                'wallet': 'text-coral-pink',
                'lists': 'text-purple-600',
                'info': 'text-blue-700'
            };
            btn.classList.add(colorMap[tabId]);
        }

        function renderItinerary() {
            const container = document.getElementById('itinerary-container');
            let html = '';
            itineraryData.forEach((item) => {
                html += `
                    <details class="group bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <summary class="flex items-center justify-between p-4 cursor-pointer bg-white group-open:bg-gray-50 transition">
                            <div class="flex items-center gap-3">
                                <div>
                                    <h3 class="font-bold text-lg text-gray-800">${item.day} <span class="text-sm font-normal text-gray-600 ml-1">${item.date}</span></h3>
                                    <p class="text-xs text-gray-500 truncate w-60">${item.loc}</p>
                                </div>
                            </div>
                            <i class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <div class="p-4 pt-0 border-t border-gray-100 bg-gray-50 text-sm">
                            <div class="relative pl-4 border-l-2 border-gray-300 space-y-6 mt-4">
                                ${item.timeline.map(t => `
                                    <div class="relative">
                                        <div class="absolute -left-[21px] top-1.5 w-3 h-3 rounded-full border-2 border-white ${t.type === 'hotel' ? 'bg-purple-500' : 'bg-gray-400'}"></div>
                                        <div class="flex justify-between items-start gap-2">
                                            <div class="flex-1">
                                                <span class="font-mono text-sm font-bold text-gray-600 block mb-0.5">${t.time}</span>
                                                <h4 class="font-bold text-gray-800 text-base">${t.title}</h4>
                                                ${t.desc ? `<p class="text-gray-600 mt-1 leading-relaxed">${t.desc}</p>` : ''}
                                                ${t.link ? `<a href="${t.link}" target="_blank" class="inline-block mt-2 text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded hover:bg-orange-200"><i class="fa-solid fa-utensils mr-1"></i>é¤å»³é€£çµ</a>` : ''}
                                                ${t.map ? `<a href="${t.map}" target="_blank" class="inline-block mt-2 ml-2 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded hover:bg-cyan-200"><i class="fa-solid fa-map-location-dot mr-1"></i>åœ°åœ–</a>` : ''}
                                            </div>
                                            ${t.traffic ? `<div class="shrink-0 max-w-[40%] text-right"><span class="inline-block text-[11px] bg-blue-100 text-blue-800 border border-blue-200 px-2 py-1 rounded-md leading-tight text-center">${t.traffic}</span></div>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </details>
                `;
            });
            container.innerHTML = html;
        }

        const calcInput = document.getElementById('calc-input');
        const calcResult = document.getElementById('calc-result');
        const rateInput = document.getElementById('exchange-rate');

        function initCalc() {
            const savedRate = localStorage.getItem('honeymoon_rate');
            if (savedRate) rateInput.value = savedRate;
            calcInput.addEventListener('input', calculate);
        }

        function calculate() {
            const val = parseFloat(calcInput.value) || 0;
            const rate = parseFloat(rateInput.value) || 4.5;
            const res = Math.round(val * rate);
            calcResult.textContent = res.toLocaleString();
        }

        function saveRate() {
            localStorage.setItem('honeymoon_rate', rateInput.value);
            calculate();
        }

        let expenses = JSON.parse(localStorage.getItem('honeymoon_expenses_v2')) || [];
        let editingIndex = -1;

        function renderExpenses() {
            const list = document.getElementById('expense-list');
            
            if (expenses.length === 0) {
                list.innerHTML = '<li class="text-center text-gray-400 py-4 text-sm">å°šç„¡è¨˜å¸³è³‡æ–™</li>';
            } else {
                list.innerHTML = expenses.slice(0, 10).map((ex, idx) => { 
                    let displayAmt = ex.currency === 'TWD' ? `$${ex.amount}` : `${ex.currency} ${ex.amount}`;
                    
                    let methodIconClass = 'text-gray-500';
                    let methodIcon = 'fa-credit-card';
                    
                    if (ex.paymentMethod === 'ç¾é‡‘') {
                        methodIcon = 'fa-money-bill-1';
                        methodIconClass = 'text-orange-500';
                    } else if (ex.paymentMethod === 'çˆ¸åª½ç¾é‡‘') {
                        methodIcon = 'fa-hand-holding-dollar';
                        methodIconClass = 'text-purple-500';
                    }

                    return `
                    <li class="bg-white p-3 rounded-lg shadow-sm border border-gray-200 flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            ${ex.img ? `<img src="${ex.img}" class="w-10 h-10 rounded object-cover border border-gray-300" onclick="viewImage('${ex.img}')">` : '<div class="w-10 h-10 rounded bg-gray-100 flex items-center justify-center text-gray-400 border border-gray-200"><i class="fa-solid fa-dollar-sign"></i></div>'}
                            <div>
                                <div class="font-bold text-gray-800 text-sm">${ex.item} <i class="fa-solid ${methodIcon} ${methodIconClass} text-[10px] ml-1 opacity-70"></i></div>
                                <div class="text-[10px] text-gray-500">${ex.date} â€¢ ${ex.payer}ä»˜</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-coral-pink text-sm">${displayAmt}</span>
                            <button onclick="editExpense(${idx})" class="text-gray-400 hover:text-blue-500"><i class="fa-solid fa-pen"></i></button>
                            <button onclick="deleteExpense(${idx})" class="text-gray-400 hover:text-red-500"><i class="fa-solid fa-trash-can"></i></button>
                        </div>
                    </li>
                `}).join('');
            }
            renderSummary();
        }

        function renderSummary() {
            const tbody = document.getElementById('summary-table-body');
            let html = '';
            
            // ç¾é‡‘éŒ¢åŒ…åˆå§‹èˆ‡é¤˜é¡è¨ˆç®—
            const cashWallets = { USD: 150, SGD: 200, MYR: 600 };
            let parentsUsd = 2000;
            
            // è¨ˆç®—ç›®å‰å·²æ‰£é™¤çš„ç¾é‡‘
            expenses.forEach(ex => {
                // åŸæœ‰ç¾é‡‘é‚è¼¯
                if (ex.paymentMethod === 'ç¾é‡‘' && cashWallets.hasOwnProperty(ex.currency)) {
                    cashWallets[ex.currency] -= parseFloat(ex.amount);
                }
                // çˆ¸åª½ç¾é‡‘é‚è¼¯ (åªæ‰£ç¾é‡‘)
                if (ex.paymentMethod === 'çˆ¸åª½ç¾é‡‘' && ex.currency === 'USD') {
                    parentsUsd -= parseFloat(ex.amount);
                }
            });

            // æ›´æ–°éŒ¢åŒ… UI
            document.getElementById('wallet-usd').textContent = cashWallets.USD.toFixed(1);
            document.getElementById('wallet-sgd').textContent = cashWallets.SGD.toFixed(1);
            document.getElementById('wallet-myr').textContent = cashWallets.MYR.toFixed(1);
            document.getElementById('wallet-parents-usd').textContent = parentsUsd.toFixed(1);

            // 1. Initial Budget/Pre-paid Items
            initialSummaryData.forEach(row => {
                html += `
                    <tr>
                        <td class="text-center">
                            <div class="font-bold text-gray-700 leading-tight">${row.item}</div>
                            <div class="text-[10px] text-gray-400 bg-gray-100 inline-block px-1 rounded mt-0.5">${row.cat}</div>
                        </td>
                        <td class="text-center text-gray-600 text-sm whitespace-nowrap">${row.junan > 0 ? row.junan.toLocaleString() : '-'}</td>
                        <td class="text-center text-gray-600 text-sm whitespace-nowrap">${row.yuyun > 0 ? row.yuyun.toLocaleString() : '-'}</td>
                    </tr>
                `;
            });

            // 2. Added Expenses (Convert to TWD for summary)
            const rates = { 'TWD': 1, 'SGD': 24.745, 'MYR': 8.24, 'MVR': 2.1, 'USD': 31.68666 }; 
            
            let totalJunan = initialSummaryData.reduce((acc, cur) => acc + cur.junan, 0);
            let totalYuyun = initialSummaryData.reduce((acc, cur) => acc + cur.yuyun, 0);

            if(expenses.length > 0) {
                html += `<tr><td colspan="3" class="bg-blue-50 text-center font-bold text-xs py-1 text-blue-600">æ—…é€”æ–°å¢æ”¯å‡º</td></tr>`;
                
                expenses.forEach(ex => {
                    const rate = rates[ex.currency] || 1;
                    const twdVal = Math.round(ex.amount * rate);
                    const isJunan = ex.payer === 'ä¿Šå®‰';
                    const isParents = ex.paymentMethod === 'çˆ¸åª½ç¾é‡‘';
                    
                    // åªæœ‰éçˆ¸åª½ç¾é‡‘æ”¯ä»˜çš„æ‰è¨ˆå…¥åˆ†å¸³ç¸½é¡
                    if (!isParents) {
                        if(isJunan) totalJunan += twdVal;
                        else totalYuyun += twdVal;
                    }

                    html += `
                        <tr>
                            <td class="text-center">
                                <div class="font-bold text-gray-700 leading-tight">${ex.item} <span class="text-[9px] text-gray-400">(${ex.paymentMethod})</span></div>
                                <div class="text-[10px] text-gray-400">${ex.currency !== 'TWD' ? `(${ex.currency} ${ex.amount})` : ''}</div>
                            </td>
                            <td class="text-center text-gray-600 text-sm whitespace-nowrap">${!isParents && isJunan ? twdVal.toLocaleString() : '-'}</td>
                            <td class="text-center text-gray-600 text-sm whitespace-nowrap">${!isParents && !isJunan ? twdVal.toLocaleString() : '-'}</td>
                        </tr>
                    `;
                });
            }

            tbody.innerHTML = html;
            document.getElementById('total-junan').textContent = totalJunan.toLocaleString();
            document.getElementById('total-yuyun').textContent = totalYuyun.toLocaleString();

            const totalAll = totalJunan + totalYuyun;
            document.getElementById('total-all').textContent = totalAll.toLocaleString();
            
            const split = totalAll / 2;
            const diff = totalJunan - split;

            const msgEl = document.getElementById('settlement-msg');
            if(diff > 0) {
                msgEl.innerHTML = `æ¯“èŠ¸ éœ€çµ¦ ä¿Šå®‰ <span class="text-red-500">$${Math.round(diff).toLocaleString()}</span>`;
            } else if (diff < 0) {
                msgEl.innerHTML = `ä¿Šå®‰ éœ€çµ¦ æ¯“èŠ¸ <span class="text-red-500">$${Math.round(Math.abs(diff)).toLocaleString()}</span>`;
            } else {
                msgEl.textContent = "ç›®å‰çµæ¸…";
            }
        }

        let currentImgBase64 = null;
        
        document.getElementById('expense-img').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const maxWidth = 300; 
                    const scale = maxWidth / img.width;
                    canvas.width = maxWidth;
                    canvas.height = img.height * scale;
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    currentImgBase64 = canvas.toDataURL('image/jpeg', 0.7);
                    document.getElementById('img-preview').src = currentImgBase64;
                    document.getElementById('img-preview-area').classList.remove('hidden');
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(file);
        });

        function clearImage() {
            currentImgBase64 = null;
            document.getElementById('expense-img').value = '';
            document.getElementById('img-preview-area').classList.add('hidden');
        }

        function editExpense(idx) {
            const ex = expenses[idx];
            document.getElementById('expense-item').value = ex.item;
            document.getElementById('expense-amount').value = ex.amount;
            document.getElementById('expense-currency').value = ex.currency;
            document.getElementById('expense-cat').value = ex.cat;
            
            const radios = document.getElementsByName('payer');
            for(const radio of radios) {
                if(radio.value === ex.payer) radio.checked = true;
            }
            
            const methodRadios = document.getElementsByName('paymentMethod');
            for(const radio of methodRadios) {
                if(radio.value === (ex.paymentMethod || 'ä¿¡ç”¨å¡')) radio.checked = true;
            }

            if(ex.img) {
                currentImgBase64 = ex.img;
                document.getElementById('img-preview').src = ex.img;
                document.getElementById('img-preview-area').classList.remove('hidden');
            } else {
                clearImage();
            }

            editingIndex = idx;
            const btn = document.getElementById('add-expense-btn');
            btn.textContent = "ç¢ºèªä¿®æ”¹";
            btn.classList.replace('bg-coral-pink', 'bg-blue-500');
            document.getElementById('cancel-edit-btn').classList.remove('hidden');
            document.getElementById('tab-wallet').scrollIntoView({ behavior: 'smooth' });
        }

        function cancelEdit() {
            editingIndex = -1;
            document.getElementById('expense-item').value = '';
            document.getElementById('expense-amount').value = '';
            clearImage();
            const btn = document.getElementById('add-expense-btn');
            btn.textContent = "è¨˜å¸³ä¸¦åŒæ­¥è‡³å ±è¡¨";
            btn.classList.replace('bg-blue-500', 'bg-coral-pink');
            document.getElementById('cancel-edit-btn').classList.add('hidden');
        }

        function addExpense() {
            const item = document.getElementById('expense-item').value;
            const amount = document.getElementById('expense-amount').value;
            const currency = document.getElementById('expense-currency').value;
            const cat = document.getElementById('expense-cat').value;
            const payer = document.querySelector('input[name="payer"]:checked').value;
            const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            
            if (!item || !amount) {
                alert('è«‹è¼¸å…¥é …ç›®å’Œé‡‘é¡');
                return;
            }

            if (editingIndex > -1) {
                expenses[editingIndex] = {
                    item, amount, currency, cat, payer, paymentMethod,
                    img: currentImgBase64,
                    date: expenses[editingIndex].date 
                };
                cancelEdit();
            } else {
                const now = new Date();
                const dateStr = `${now.getMonth()+1}/${now.getDate()}`;
                expenses.unshift({
                    item, amount, currency, cat, payer, paymentMethod,
                    img: currentImgBase64,
                    date: dateStr
                });
            }

            localStorage.setItem('honeymoon_expenses_v2', JSON.stringify(expenses));
            if(editingIndex === -1) {
                document.getElementById('expense-item').value = '';
                document.getElementById('expense-amount').value = '';
                clearImage();
            }
            renderExpenses();
            switchTab('summary');
        }

        let deleteTargetIndex = -1;
        function deleteExpense(idx) {
            deleteTargetIndex = idx;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            deleteTargetIndex = -1;
        }

        function confirmDelete() {
            if(deleteTargetIndex > -1) {
                expenses.splice(deleteTargetIndex, 1);
                localStorage.setItem('honeymoon_expenses_v2', JSON.stringify(expenses));
                if (editingIndex === deleteTargetIndex) cancelEdit();
                else if (editingIndex > deleteTargetIndex) editingIndex--;
                renderExpenses();
            }
            closeDeleteModal();
        }

        function viewImage(src) {
            const w = window.open("");
            w.document.write('<img src="'+src+'" style="max-width:100%"/>');
        }

        let checklistState = JSON.parse(localStorage.getItem('honeymoon_checklist_state')) || {};

        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            let html = '';
            checklistData.forEach((section, sIdx) => {
                html += `
                    <details class="group bg-white border-b border-gray-100 last:border-b-0">
                        <summary class="flex items-center justify-between p-4 cursor-pointer bg-${section.bg ? section.bg.split('-')[1] : 'white'} hover:bg-opacity-80 transition">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full ${section.bg} flex items-center justify-center ${section.color}">
                                    <i class="fa-solid ${section.icon}"></i>
                                </div>
                                <h4 class="font-bold text-gray-800">${section.title}</h4>
                            </div>
                            <i class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <div class="p-4 pt-2 bg-gray-50 text-sm">
                `;
                if (section.items.length === 0 || (section.items.length === 1 && section.items[0].list[0] === "(å°šæœªæ–°å¢é …ç›®)")) {
                     html += `<div class="text-center text-gray-400 py-2">å°šç„¡é …ç›®</div>`;
                } else {
                    section.items.forEach((catGroup, cIdx) => {
                        html += `<div class="mb-4 last:mb-0">
                                    <h5 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 border-b border-gray-200 pb-1">${catGroup.cat}</h5>
                                    <div class="space-y-2">`;
                        catGroup.list.forEach((itemText, iIdx) => {
                            const itemId = `check_${sIdx}_${cIdx}_${iIdx}`;
                            const isChecked = checklistState[itemId] || false;
                            html += `
                                <div class="flex items-start">
                                    <div class="flex h-5 items-center">
                                        <input id="${itemId}" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-island-blue focus:ring-island-blue cursor-pointer" ${isChecked ? 'checked' : ''} onchange="toggleCheck('${itemId}')">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="${itemId}" class="font-medium text-gray-700 cursor-pointer ${isChecked ? 'line-through text-gray-400' : ''}">${itemText}</label>
                                    </div>
                                </div>
                            `;
                        });
                        html += `   </div></div>`;
                    });
                }
                html += `</div></details>`;
            });
            container.innerHTML = html;
        }

        function toggleCheck(id) {
            const checkbox = document.getElementById(id);
            const label = document.querySelector(`label[for="${id}"]`);
            checklistState[id] = checkbox.checked;
            localStorage.setItem('honeymoon_checklist_state', JSON.stringify(checklistState));
            if (checkbox.checked) label.classList.add('line-through', 'text-gray-400');
            else label.classList.remove('line-through', 'text-gray-400');
        }

        const memoArea = document.getElementById('memo-area');
        const memoLinks = document.getElementById('memo-links');

        function initMemo() {
            memoArea.value = localStorage.getItem('honeymoon_memo') || '';
            parseLinks();
            memoArea.addEventListener('input', function() {
                localStorage.setItem('honeymoon_memo', this.value);
                parseLinks();
            });
        }

        function parseLinks() {
            const text = memoArea.value;
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            const matches = text.match(urlRegex);
            if (matches && matches.length > 0) {
                memoLinks.innerHTML = matches.map(url => 
                    `<a href="${url}" target="_blank" class="block truncate text-blue-600 hover:underline"><i class="fa-solid fa-link mr-1 text-xs"></i>${url}</a>`
                ).join('');
            } else memoLinks.innerHTML = '';
        }

        window.addEventListener('DOMContentLoaded', () => {
            renderItinerary();
            initCalc();
            renderExpenses();
            renderChecklist();
            initMemo();
            switchTab('plan');
        });
    </script>
</body>
</html>
